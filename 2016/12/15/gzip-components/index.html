<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- For SEO -->
  <meta name="baidu-site-verification" content="UFDznXUqi2" />
  <meta name="google-site-verification" content="6OTH-Srp0OtcTNkRErkCMoIbSMy8aoG0RiRBifvwKuU" />

  <!-- For open search -->
  <link rel="search" type="application/opensearchdescription+xml" href="http://maxpeng.vipcloud.me/opensearch.xml" title="Blog Search" />

  
  <title>前端性能调优(4) ┃ Gzip 压缩 | 谋事在人，成事在天</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="原文链接：https://developer.yahoo.com/performance/rules.html#gzip

通过网络传输 HTTP 请求和响应所需的时间可以根据前端工程师做出的决定大大减少。的确，终端用户的带宽速度、互联网服务提供商、对等交换点的距离等都超出了开发团队的控制范围。但还有其他影响响应时间的变量。压缩通过减少 HTTP 响应的大小来减少响应时间。">
<meta property="og:type" content="article">
<meta property="og:title" content="前端性能调优(4) ┃ Gzip 压缩">
<meta property="og:url" content="http://maxpeng.vipcloud.me/2016/12/15/gzip-components/index.html">
<meta property="og:site_name" content="谋事在人，成事在天">
<meta property="og:description" content="原文链接：https://developer.yahoo.com/performance/rules.html#gzip

通过网络传输 HTTP 请求和响应所需的时间可以根据前端工程师做出的决定大大减少。的确，终端用户的带宽速度、互联网服务提供商、对等交换点的距离等都超出了开发团队的控制范围。但还有其他影响响应时间的变量。压缩通过减少 HTTP 响应的大小来减少响应时间。">
<meta property="og:image" content="http://maxpeng.vipcloud.me/imgs/gzip.png">
<meta property="og:updated_time" content="2017-01-22T06:39:31.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端性能调优(4) ┃ Gzip 压缩">
<meta name="twitter:description" content="原文链接：https://developer.yahoo.com/performance/rules.html#gzip

通过网络传输 HTTP 请求和响应所需的时间可以根据前端工程师做出的决定大大减少。的确，终端用户的带宽速度、互联网服务提供商、对等交换点的距离等都超出了开发团队的控制范围。但还有其他影响响应时间的变量。压缩通过减少 HTTP 响应的大小来减少响应时间。">
<meta name="twitter:image" content="http://maxpeng.vipcloud.me/imgs/gzip.png">
<meta name="twitter:creator" content="@pengisgood">
<link rel="publisher" href="pengisgood">
  
    <link rel="alternate" href="/atom.xml" title="谋事在人，成事在天" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">谋事在人，成事在天</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://maxpeng.vipcloud.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article data-post-id="ciy8c9n8v0009tx1k85n2xepz" id="post-gzip-components" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/15/gzip-components/" class="article-date">
  <time datetime="2016-12-15T10:56:15.000Z" itemprop="datePublished">Dec 15 2016</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>►<a class="article-category-link" href="/categories/Web/Performance/">Performance</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      前端性能调优(4) ┃ Gzip 压缩
    </h1>
  

        <div class="views">0</div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/imgs/gzip.png" width="100%"></p>
<blockquote>
<p><em>原文链接：<a href="https://developer.yahoo.com/performance/rules.html#gzip" target="_blank" rel="external">https://developer.yahoo.com/performance/rules.html#gzip</a></em></p>
</blockquote>
<p>通过网络传输 HTTP 请求和响应所需的时间可以根据前端工程师做出的决定大大减少。的确，终端用户的带宽速度、互联网服务提供商、对等交换点的距离等都超出了开发团队的控制范围。但还有其他影响响应时间的变量。压缩通过减少 HTTP 响应的大小来减少响应时间。</p>
<a id="more"></a>
<p>从 HTTP/1.1 开始，Web 客户端在 HTTP 请求中的 <code>Accept-Encoding</code> 头中指定是否支持压缩。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure>
<p>如果 Web 服务器在请求中看到此标头，它可以使用客户端列出的方法之一来压缩响应。Web 服务器通过响应中的 <code>Content-Encoding</code> 头来通知 Web 客户端。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Encoding: gzip</span><br></pre></td></tr></table></figure>
<p>Gzip 是目前最流行和最有效的压缩方法。它是由 GNU 项目开发的，并在 <a href="http://www.ietf.org/rfc/rfc1952.txt" target="_blank" rel="external">RFC 1952</a> 中标准化。你可能看到的唯一其他压缩格式是 <code>deflate</code>，但它的效率较低且没有那么流行。</p>
<p>Gzip 通常将响应大小减小约70％。目前浏览器中大约90％的互联网流量声称支持 gzip。如果使用 Apache，那么配置 gzip 的模块取决于你的版本：Apache 1.3 使用 <a href="https://sourceforge.net/projects/mod-gzip/" target="_blank" rel="external">mod_gzip</a>，而Apache 2.x 使用 <a href="http://httpd.apache.org/docs/2.0/mod/mod_deflate.html" target="_blank" rel="external">mod_deflate</a>。</p>
<p>有一些已知的浏览器和代理问题，可能导致浏览器期望的内容与接收到的压缩内容不匹配。幸运的是，这些边缘情况随着旧版浏览器的使用率下降正在逐渐减少。Apache 模块也会自动添加适当的 <code>Vary</code> 响应头来帮助解决这些问题。</p>
<p>服务器根据文件类型选择 gzip 的内容，但是它们决定压缩的内容通常太受限制。大多数网站 gzip 它们的 HTML 文档。还有一点值得 gzip 的是脚本和样式表，但许多网站错过了这个机会。事实上，压缩任何文本响应，包括 XML 和 JSON 都是值得压缩的。<strong>图像和 PDF 文件不应该 gzip，因为它们已经压缩过了</strong>。尝试 gzip 它们不仅浪费 CPU，还有可能增加文件大小。</p>
<p>Gzip 尽可能多的文件类型是减少页面重量和加快用户体验的简单方法。</p>
<h2 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h2><blockquote>
<h3 id="Gzip-Components"><a href="#Gzip-Components" class="headerlink" title="Gzip Components"></a>Gzip Components</h3><p>tag: server</p>
<p>The time it takes to transfer an HTTP request and response across the network can be significantly reduced by decisions made by front-end engineers. It’s true that the end-user’s bandwidth speed, Internet service provider, proximity to peering exchange points, etc. are beyond the control of the development team. But there are other variables that affect response times. Compression reduces response times by reducing the size of the HTTP response.</p>
<p>Starting with HTTP/1.1, web clients indicate support for compression with the Accept-Encoding header in the HTTP request.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure>
<p>If the web server sees this header in the request, it may compress the response using one of the methods listed by the client. The web server notifies the web client of this via the Content-Encoding header in the response.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Encoding: gzip</span><br></pre></td></tr></table></figure></p>
<p>Gzip is the most popular and effective compression method at this time. It was developed by the GNU project and standardized by <a href="http://www.ietf.org/rfc/rfc1952.txt" target="_blank" rel="external">RFC 1952</a>. The only other compression format you’re likely to see is deflate, but it’s less effective and less popular.</p>
<p>Gzipping generally reduces the response size by about 70%. Approximately 90% of today’s Internet traffic travels through browsers that claim to support gzip. If you use Apache, the module configuring gzip depends on your version: Apache 1.3 uses <a href="https://sourceforge.net/projects/mod-gzip/" target="_blank" rel="external">mod_gzip</a> while Apache 2.x uses <a href="http://httpd.apache.org/docs/2.0/mod/mod_deflate.html" target="_blank" rel="external">mod_deflate</a>.</p>
<p>There are known issues with browsers and proxies that may cause a mismatch in what the browser expects and what it receives with regard to compressed content. Fortunately, these edge cases are dwindling as the use of older browsers drops off. The Apache modules help out by adding appropriate Vary response headers automatically.</p>
<p>Servers choose what to gzip based on file type, but are typically too limited in what they decide to compress. Most web sites gzip their HTML documents. It’s also worthwhile to gzip your scripts and stylesheets, but many web sites miss this opportunity. In fact, it’s worthwhile to compress any text response including XML and JSON. Image and PDF files should not be gzipped because they are already compressed. Trying to gzip them not only wastes CPU but can potentially increase file sizes.</p>
<p>Gzipping as many file types as possible is an easy way to reduce page weight and accelerate the user experience.</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://maxpeng.vipcloud.me/2016/12/15/gzip-components/" data-id="ciy8c9n8v0009tx1k85n2xepz" class="article-share-link">分享</a>

      
        <a class="article-tip-link">打赏</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Best-Practice/">Best Practice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/翻译/">翻译</a></li></ul>


      <div class="tip-container">
        <div id="ciy8c9n8v0009tx1k85n2xepz" class="article-tip-box">
          <div class="payment-method">
            <label for="tip-alipay" class="article-tip-select" data-method="alipay">
              <input id="tip-alipay" name="tip" type="radio" checked/>
              支付宝
            </label>
            <label for="tip-wechat" class="article-tip-select" data-method="wechat">
              <input id="tip-wechat" name="tip" type="radio"/>
              微信
            </label>
          </div>
          <img id="alipay" src="/imgs/alipay.png">
          <img id="wechat" class="hidden" src="/imgs/wechat.png">
        </div>
      </div>
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/01/22/put-stylesheets-at-the-top/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          前端性能调优(5) ┃ 将 Stylesheets 放在顶部
        
      </div>
    </a>
  
  
    <a href="/2016/12/13/add-an-expires-or-a-cache-control-header/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">前端性能调优(3) ┃ 添加 Expires 或者 Cache-Control 头</div>
    </a>
  
</nav>

  
</article>


  <ul class="ds-recent-visitors"></ul>

  
    <section id="comments">
      <div class="ds-thread" data-thread-key="post-gzip-components" data-title="前端性能调优(4) ┃ Gzip 压缩" data-url="http://maxpeng.vipcloud.me/2016/12/15/gzip-components/"></div>
    </section>
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:'pengisgood'};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
       || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">About me</h3>
  <div class="widget">
    <p><strong>彭洪伟</strong></p>
    <p><a href="mailto:pengisgood@gmail.com">PengIsGood[@]gmail.com</a></p>
    <p><a href="https://www.thoughtworks.com/" style="color: black;"><strong>Thought</strong>Works</a> 一线码农。</p>
    <p>
      Angular早期使用者，<a href="http://ngnice.com/">ngnice</a>的早期贡献者之一。除了前端技术，对Java、Scala、Ruby等也均有涉猎，并且翻译了构建工具<a href="http://www.scala-sbt.org/0.13/docs/zh-cn/index.html">SBT</a>的文档。
    </p>
    <p><a href="https://item.jd.com/11845736.html"><img src="/imgs/angular-best-practice.png" alt="" style="width:100%"/></a></p>
  </div>
</div>

  
    <div align="center">
  <a href="http://www.amazingcounters.com">
    <img border="0" src="http://cc.amazingcounters.com/counter.php?i=3199418&c=9598567" alt="AmazingCounters.com">
  </a>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/01/22/put-stylesheets-at-the-top/">前端性能调优(5) ┃ 将 Stylesheets 放在顶部</a>
          </li>
        
          <li>
            <a href="/2016/12/15/gzip-components/">前端性能调优(4) ┃ Gzip 压缩</a>
          </li>
        
          <li>
            <a href="/2016/12/13/add-an-expires-or-a-cache-control-header/">前端性能调优(3) ┃ 添加 Expires 或者 Cache-Control 头</a>
          </li>
        
          <li>
            <a href="/2016/12/02/Use-a-Content-Delivery-Network/">前端性能调优(2) ┃ 使用 CDN</a>
          </li>
        
          <li>
            <a href="/2016/12/02/Minimize-HTTP-Requests/">前端性能调优(1) ┃ 尽可能减少 HTTP 请求</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/">DevOps</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">9</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Web/Performance/">Performance</a><span class="category-list-count">5</span></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AngularJS/">AngularJS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ansible/">Ansible</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Best-Practice/">Best Practice</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6/">ES6</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SCSS/">SCSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sass/">Sass</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Skype/">Skype</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vagrant/">Vagrant</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a><span class="tag-list-count">7</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


  
</aside>

        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 <a href="http://stackoverflow.com/story/maxpeng" target="_blank">彭洪伟（Max Peng）</a><br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    <script src="//code.jquery.com/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor:pointer;z-index:1;">
  <a title="返回顶部"><img src="/imgs/back-to-top.png" style="width:32px;height:32px;"/></a>
</div>

<script src="/js/backToTop.js"></script>

<!--Lean Cloud-->
<!-- lean cloud js -->
<!--refer to: https://leancloud.cn/docs/leanstorage_guide-js.html#更新计数器 -->
<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<script>
  $(document).ready(function () {
    // 应用 ID，用来识别应用
    var APP_ID = 'P73z6DPIAfc1Jrptt0PnMore-gzGzoHsz';

    // 应用 Key，用来校验权限（Web 端可以配置安全域名来保护数据安全）
    var APP_KEY = '4n4rEhNfzn6RYUbRcpgCus7h';

    // 初始化
    AV.init({appId: APP_ID, appKey: APP_KEY});

    
    var query = new AV.Query('PageView');
    var postId = $('article').data('postId');
    var postSlug = $('article').attr('id');

    query.equalTo('postSlug', postSlug);
    query.first().then(function (pageView) {
      if (pageView) {
        increasePageView(pageView);
      } else {
        var PageView = AV.Object.extend('PageView');
        var pageView = new PageView();
        pageView.save({
          postId: postId,
          postSlug: postSlug,
          views: 0
        }).then(function (pageView) {
          increasePageView(pageView);
        })
      }
    }, function (error) {
    });

    function increasePageView(pageView) {
      pageView.increment('views', 1);
      pageView.fetchWhenSave(true);
      pageView.save().then(function (pageView) {
        updatePageView(pageView)
      });
    }
    

    function updatePageView(pageView) {
      var id = pageView.get('postSlug');
      $('#' + id + ' .views').html(pageView.get('views'));
    }
  })
</script>


  </div>
  
<!--CNZZ-->
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
  document.write(unescape("%3Cspan id='cnzz_stat_icon_1257186032'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1257186032' type='text/javascript'%3E%3C/script%3E"));</script>


</body>
</html>
